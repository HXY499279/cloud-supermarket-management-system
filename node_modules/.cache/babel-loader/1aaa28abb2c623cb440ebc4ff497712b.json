{"ast":null,"code":"import _objectSpread from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Descriptions,Divider,Breadcrumb,Button,Input,message,InputNumber,DatePicker,Table,ConfigProvider,Popconfirm,Space,Empty}from'antd';import{nanoid}from'nanoid';import reqwest from'reqwest';import{SearchOutlined}from'@ant-design/icons';import'./index.css';// 配置中文环境\nimport zh_CN from'antd/lib/locale-provider/zh_CN';import'moment/locale/zh-cn';// 引用工具\nimport ofStatusToChinese from'../../../utils/ofStatusToChinese';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RangePicker=DatePicker.RangePicker;var Om=/*#__PURE__*/function(_Component){_inherits(Om,_Component);var _super=_createSuper(Om);function Om(){var _this;_classCallCheck(this,Om);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={date:[],data:[],pagination:{current:1,pageSize:5,total:''},loading:false,status:'willdelivery',ofDetails:[]};_this.confirmStatus=function(){switch(_this.state.status){case\"willdelivery\":return\"willdelivery\";case\"delivery\":return\"delivery\";case\"success\":return\"success\";case\"refund\":return\"refund\";case\"refunded\":return\"refunded\";default:return\"sendgoods\";}};_this.getColumns=function(){var columns=[{title:'订单id',dataIndex:'ofid',key:'ofid',defaultSortOrder:'ascend',sorter:function sorter(a,b){return a.id-b.id;}},{title:'用户id',dataIndex:'uid',key:'uid'},{title:'总价',dataIndex:'totalPrice',key:'totalPrice'},{title:'下单时间',dataIndex:'time',key:'time'},{title:'备注',dataIndex:'remarks',key:'remarks'},{title:'订单状态',dataIndex:'status',key:'status',className:_this.confirmStatus()},_this.state.status!==\"success\"&&_this.state.status!==\"refunded\"?{title:'操作',dataIndex:'ofid',key:'ofid',render:function render(ofid){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",style:{borderRadius:5,marginLeft:20},children:/*#__PURE__*/_jsx(Popconfirm,{title:\"\\u786E\\u5B9A\".concat(_this.changeOprationButtonWord(_this.state.status),\"\\u5417?\"),onConfirm:_this.confirmChangeStatus.bind(_assertThisInitialized(_this),ofid),okText:\"\\u786E\\u8BA4\",cancelText:\"\\u53D6\\u6D88\",children:_this.changeOprationButtonWord(_this.state.status)})})});}}:{className:\"of-last-item-hidden\"}];return columns;};_this.changeOprationButtonWord=function(status){switch(status){case\"willdelivery\":return\"发货\";case\"delivery\":return\"完成订单\";case\"refund\":return\"退款\";default:return\"发货\";}};_this.confirmChangeStatus=function(ofid){var _this$state$paginatio=_this.state.pagination,current=_this$state$paginatio.current,pageSize=_this$state$paginatio.pageSize;var data={ofid:ofid,current:current,pageSize:pageSize,startStatus:_this.state.status,endStatus:_this.confirmEndStatus()};reqwest({// 后端接口\nurl:'/om/changeofstatus',method:'post',type:'json',// 传递给后端的数据\ndata:data})//根据返回的状态码status判断是否删除用户成功\n.then(function(res){console.log(res);var data=res;ofStatusToChinese(data.results);_this.setState({data:data.results});if(res.status==='success'){message.success('处理成功');}else{message.error('处理失败');}});};_this.confirmEndStatus=function(){switch(_this.state.status){case\"willdelivery\":return\"delivery\";case\"delivery\":return\"success\";case\"refund\":return\"refunded\";default:return;}};_this.dateOnChange=function(value,dateString){var startDate=dateString[0].replace(/\\//g,\"-\");var endDate=dateString[1].replace(/\\//g,\"-\");var date=[startDate,endDate];_this.setState({date:date});};_this.OmSearch=function(){console.log(_this.state.date);var _ref=[_this.ofidInput.value,_this.uidInput.state.value,_this.state.date[0],_this.state.date[1],_this.state.status],ofid=_ref[0],uid=_ref[1],dateSta=_ref[2],dateEnd=_ref[3],status=_ref[4];dateSta=JSON.stringify(dateSta);dateEnd=JSON.stringify(dateEnd);var data={ofid:ofid,uid:uid,dateSta:dateSta,dateEnd:dateEnd,status:status};console.log(data);reqwest({url:'/om/searchorderform',method:'post',type:'json',data:data}).then(function(data){// 数据处理-给每条数据添加独立的key\nif(data.total!==0){console.log(data);data.results.forEach(function(item){item.key=nanoid();});ofStatusToChinese(data.results);var pagination=_this.state.pagination;pagination.total=data.total;_this.setState({data:data.results,pagination:pagination});message.success(\"查询成功\");}else{message.error(\"查无订单\");}});};_this.handleTableChange=function(pagination){console.log(pagination);var current=pagination.current,pageSize=pagination.pageSize;// console.log(pagination)\n_this.setState({pagination:{current:current,pageSize:pageSize}});_this.fetch({pagination:pagination});};_this.getRandomuserParams=function(params){return{current:params.pagination.current,pageSize:params.pagination.pageSize,status:_this.state.status};};_this.fetch=function(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_this.setState({loading:true});reqwest({// 后端接口\nurl:'/om/oflist',method:'post',type:'json',// 传递给后端的数据\ndata:_this.getRandomuserParams(params)}).then(function(data){// 数据处理-给每条数据添加独立的key\ndata.results.forEach(function(item){item.key=nanoid();});// 数据处理-将status从英文变成中文在页面显示\nconsole.log(data);ofStatusToChinese(data.results);_this.setState({loading:false,// 根据接口返回的数据源\ndata:data.results,pagination:_objectSpread(_objectSpread({},params.pagination),{},{// 根据接口返回的总条数\ntotal:data.total})});});};_this.changeStatusAndPost=function(status){var pagination=_this.state.pagination;_this.setState({status:status},function(){_this.fetch({pagination:pagination});});};_this.willdeliveryClick=function(){_this.changeStatusAndPost(\"willdelivery\");};_this.deliveryClick=function(){_this.changeStatusAndPost(\"delivery\");};_this.successClick=function(){_this.changeStatusAndPost(\"success\");};_this.refundClick=function(){_this.changeStatusAndPost(\"refund\");};_this.refundedClick=function(){_this.changeStatusAndPost(\"refunded\");};return _this;}_createClass(Om,[{key:\"componentDidMount\",value:function componentDidMount(){var pagination=this.state.pagination;this.fetch({pagination:pagination});}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,data=_this$state.data,pagination=_this$state.pagination,loading=_this$state.loading;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Divider,{style:{margin:0}}),/*#__PURE__*/_jsxs(\"div\",{className:\"Om-head\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Om-desc-wraper\",children:[/*#__PURE__*/_jsxs(Breadcrumb,{className:\"bdc\",children:[/*#__PURE__*/_jsx(Breadcrumb.Item,{children:/*#__PURE__*/_jsx(\"a\",{href:\"/home\",children:\"\\u4E3B\\u9875\"})}),/*#__PURE__*/_jsx(Breadcrumb.Item,{children:\"\\u8BA2\\u5355\\u4FE1\\u606F\\u7BA1\\u7406\"})]}),/*#__PURE__*/_jsx(Descriptions,{title:\"\\u8BA2\\u5355\\u7BA1\\u7406\",className:\"desc\",children:/*#__PURE__*/_jsx(Descriptions.Item,{children:\"\\u5C55\\u793A\\u8BA2\\u5355\\u4FE1\\u606F\\uFF0C\\u67E5\\u8BE2\\u8BA2\\u5355\\uFF0C\\u67E5\\u770B\\u8BA2\\u5355\\u72B6\\u6001\\uFF0C\\u5904\\u7406\\u8BA2\\u5355\\u7684\\u53D1\\u8D27\\uFF0C\\u786E\\u8BA4\\u9001\\u8FBE\\u548C\\u540C\\u610F\\u9000\\u6B3E\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-switch\",children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{className:\"status-button\",onClick:this.willdeliveryClick,children:\"\\u5F85\\u53D1\\u8D27\"}),/*#__PURE__*/_jsx(Button,{className:\"status-button\",onClick:this.deliveryClick,children:\"\\u914D\\u9001\\u4E2D\"}),/*#__PURE__*/_jsx(Button,{className:\"status-button\",onClick:this.successClick,children:\"\\u5DF2\\u6210\\u4EA4\"}),/*#__PURE__*/_jsx(Button,{className:\"status-button\",onClick:this.refundClick,children:\"\\u5F85\\u9000\\u6B3E\"}),/*#__PURE__*/_jsx(Button,{className:\"status-button\",onClick:this.refundedClick,children:\"\\u5DF2\\u9000\\u6B3E\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search\",children:[/*#__PURE__*/_jsx(Divider,{style:{margin:0}}),/*#__PURE__*/_jsxs(Space,{style:{marginTop:20},size:20,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u8BA2\\u5355id:\",/*#__PURE__*/_jsx(InputNumber,{name:\"Oid\",className:\"Om-input\",ref:function ref(elev){_this2.ofidInput=elev;}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u7528\\u6237id:\",/*#__PURE__*/_jsx(Input,{name:\"commodity\",className:\"Om-input\",ref:function ref(elev){_this2.uidInput=elev;}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u65F6\\u95F4:\",/*#__PURE__*/_jsx(ConfigProvider,{locale:zh_CN,children:/*#__PURE__*/_jsx(RangePicker,{showTime:true,format:\"YYYY-MM-DD HH:mm\",onChange:this.dateOnChange,ref:function ref(elev){_this2.dateElev=elev;}})})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:20},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",shape:\"circle\",icon:/*#__PURE__*/_jsx(SearchOutlined,{}),onClick:this.OmSearch})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tableWraper contentWraper\",children:/*#__PURE__*/_jsx(Table,{columns:this.getColumns(),dataSource:data,pagination:pagination,loading:loading,onChange:this.handleTableChange,bordered:true,expandable:{onExpand:function onExpand(boo,item){console.log(item,222222222,_this2.state.ofDetails);var tag=1;_this2.state.ofDetails.forEach(function(detail){console.log(detail.user.uid,item.uid);if(detail.commodityDetails[0].ofid===item.ofid){tag=0;}});if(tag){var _data={ofid:item.ofid,uid:item.uid};reqwest({url:'/om/ofdetails',method:\"post\",type:\"json\",data:_data}).then(function(res){console.log(res);res.commodityDetails.forEach(function(item){item.key=nanoid();});var ofDetails=_this2.state.ofDetails;ofDetails.push(res);_this2.setState({ofDetails:ofDetails});});}},expandedRowRender:function expandedRowRender(item){console.log(item.uid);console.log(_this2.state.ofDetails);var tag=0;var index;_this2.state.ofDetails.forEach(function(detail,ind){console.log(detail.user.uid,item.uid);if(detail.commodityDetails[0].ofid===item.ofid){tag=1;index=ind;}});if(tag){if(_this2.state.ofDetails!==null&&_this2.state.ofDetails[index].user!==undefined&&_this2.state.ofDetails[index].commodityDetails!==undefined){var user=_this2.state.ofDetails[index].user;var commodityDetails=_this2.state.ofDetails[index].commodityDetails;return/*#__PURE__*/_jsxs(\"div\",{className:\"sub-order\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u7528\\u6237\\u6536\\u8D27\\u5730\\u5740: \",user.address,\" \",user.uname,\" \",user.phone,\" \"]}),/*#__PURE__*/_jsx(\"p\",{style:{fontWeight:600,fontSize:14},children:\"\\u5546\\u54C1\\u8BE6\\u60C5:\"}),commodityDetails.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"commodity-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"commodity-details-item\",children:[\"\\u7F16\\u53F7: \",item.cid]}),/*#__PURE__*/_jsxs(\"div\",{className:\"commodity-details-item\",children:[\"\\u540D\\u79F0: \",item.commodityName]}),/*#__PURE__*/_jsxs(\"div\",{className:\"commodity-details-item\",children:[\"\\u6570\\u91CF: \",item.count]})]});})]});}else{return/*#__PURE__*/_jsx(Empty,{});}}}}})})]});}}]);return Om;}(Component);export{Om as default};","map":{"version":3,"sources":["D:/code/cloud-supermarket-management-system/src/components/Content/Om/Om.jsx"],"names":["React","Component","Descriptions","Divider","Breadcrumb","Button","Input","message","InputNumber","DatePicker","Table","ConfigProvider","Popconfirm","Space","Empty","nanoid","reqwest","SearchOutlined","zh_CN","ofStatusToChinese","RangePicker","Om","state","date","data","pagination","current","pageSize","total","loading","status","ofDetails","confirmStatus","getColumns","columns","title","dataIndex","key","defaultSortOrder","sorter","a","b","id","className","render","ofid","borderRadius","marginLeft","changeOprationButtonWord","confirmChangeStatus","bind","startStatus","endStatus","confirmEndStatus","url","method","type","then","res","console","log","results","setState","success","error","dateOnChange","value","dateString","startDate","replace","endDate","OmSearch","ofidInput","uidInput","uid","dateSta","dateEnd","JSON","stringify","forEach","item","handleTableChange","fetch","getRandomuserParams","params","changeStatusAndPost","willdeliveryClick","deliveryClick","successClick","refundClick","refundedClick","margin","marginTop","elev","dateElev","onExpand","boo","tag","detail","user","commodityDetails","push","expandedRowRender","index","ind","undefined","address","uname","phone","fontWeight","fontSize","map","cid","commodityName","count"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Descriptions, Divider, Breadcrumb, Button, Input, message, InputNumber, DatePicker, Table, ConfigProvider, Popconfirm, Space, Empty } from 'antd';\r\nimport { nanoid } from 'nanoid'\r\nimport reqwest from 'reqwest';\r\nimport { SearchOutlined } from '@ant-design/icons'\r\nimport './index.css'\r\n// 配置中文环境\r\nimport zh_CN from 'antd/lib/locale-provider/zh_CN';\r\nimport 'moment/locale/zh-cn';\r\n// 引用工具\r\nimport ofStatusToChinese from '../../../utils/ofStatusToChinese';\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nexport default class Om extends Component {\r\n\r\n    state = {\r\n        date: [],\r\n        data: [],\r\n        pagination: {\r\n            current: 1,\r\n            pageSize: 5,\r\n            total: ''\r\n        },\r\n        loading: false,\r\n        status: 'willdelivery',\r\n        ofDetails: []\r\n    };\r\n\r\n    // 根据状态来切换订单信息中订单状态的className来切换其颜色\r\n    confirmStatus = () => {\r\n        switch (this.state.status) {\r\n            case \"willdelivery\":\r\n                return \"willdelivery\"\r\n            case \"delivery\":\r\n                return \"delivery\"\r\n            case \"success\":\r\n                return \"success\"\r\n            case \"refund\":\r\n                return \"refund\"\r\n            case \"refunded\":\r\n                return \"refunded\"\r\n            default:\r\n                return \"sendgoods\"\r\n        }\r\n    }\r\n\r\n    getColumns = () => {\r\n        let columns = [\r\n            {\r\n                title: '订单id',\r\n                dataIndex: 'ofid',\r\n                key: 'ofid',\r\n                defaultSortOrder: 'ascend',\r\n                sorter: (a, b) => a.id - b.id,\r\n            },\r\n            {\r\n                title: '用户id',\r\n                dataIndex: 'uid',\r\n                key: 'uid'\r\n            },\r\n            {\r\n                title: '总价',\r\n                dataIndex: 'totalPrice',\r\n                key: 'totalPrice',\r\n            },\r\n\r\n            {\r\n                title: '下单时间',\r\n                dataIndex: 'time',\r\n                key: 'time',\r\n            },\r\n            {\r\n                title: '备注',\r\n                dataIndex: 'remarks',\r\n                key: 'remarks',\r\n            },\r\n            {\r\n                title: '订单状态',\r\n                dataIndex: 'status',\r\n                key: 'status',\r\n                className: this.confirmStatus()\r\n            },\r\n            (this.state.status !== \"success\" && this.state.status !== \"refunded\")\r\n                ?\r\n                {\r\n                    title: '操作',\r\n                    dataIndex: 'ofid',\r\n                    key: 'ofid',\r\n                    render: (ofid) => {\r\n                        return (\r\n                            <>\r\n                                <Button\r\n                                    type=\"primary\"\r\n                                    style={{ borderRadius: 5, marginLeft: 20 }}\r\n                                >\r\n                                    <Popconfirm\r\n                                        title={`确定${this.changeOprationButtonWord(this.state.status)}吗?`}\r\n                                        onConfirm={this.confirmChangeStatus.bind(this, ofid)}\r\n                                        okText=\"确认\"\r\n                                        cancelText=\"取消\"\r\n                                    >\r\n                                        {this.changeOprationButtonWord(this.state.status)}\r\n                                    </Popconfirm>\r\n                                </Button>\r\n                            </>\r\n                        )\r\n                    }\r\n                }\r\n                :\r\n                {\r\n                    className: \"of-last-item-hidden\"\r\n                }\r\n        ];\r\n        return columns\r\n    }\r\n\r\n    // 更改操作按钮中的文字\r\n    changeOprationButtonWord = (status) => {\r\n        switch (status) {\r\n            case \"willdelivery\":\r\n                return \"发货\"\r\n            case \"delivery\":\r\n                return \"完成订单\"\r\n            case \"refund\":\r\n                return \"退款\"\r\n            default:\r\n                return \"发货\"\r\n        }\r\n    }\r\n\r\n    // 确认更改订单状态操作\r\n    confirmChangeStatus = (ofid) => {\r\n        let { current, pageSize } = this.state.pagination\r\n        const data = {\r\n            ofid: ofid,\r\n            current,\r\n            pageSize,\r\n            startStatus: this.state.status,\r\n            endStatus: this.confirmEndStatus()\r\n        }\r\n        reqwest({\r\n            // 后端接口\r\n            url: '/om/changeofstatus',\r\n            method: 'post',\r\n            type: 'json',\r\n            // 传递给后端的数据\r\n            data: data\r\n        })\r\n            //根据返回的状态码status判断是否删除用户成功\r\n            .then(res => {\r\n                console.log(res)\r\n                let data = res\r\n                ofStatusToChinese(data.results)\r\n                this.setState({\r\n                    data: data.results\r\n                })\r\n                if (res.status === 'success') {\r\n                    message.success('处理成功');\r\n                } else {\r\n                    message.error('处理失败');\r\n                }\r\n            })\r\n    }\r\n    // 根据startStatus来判断endStatus\r\n    confirmEndStatus = () => {\r\n        switch (this.state.status) {\r\n            case \"willdelivery\":\r\n                return \"delivery\"\r\n            case \"delivery\":\r\n                return \"success\"\r\n            case \"refund\":\r\n                return \"refunded\"\r\n            default:\r\n                return\r\n        }\r\n    }\r\n\r\n    // 更改日期的提交格式\r\n    dateOnChange = (value, dateString) => {\r\n        let startDate = dateString[0].replace(/\\//g, \"-\")\r\n        let endDate = dateString[1].replace(/\\//g, \"-\")\r\n        let date = [startDate, endDate]\r\n        this.setState({\r\n            date: date\r\n        })\r\n    }\r\n\r\n    // 搜索操作\r\n    OmSearch = () => {\r\n        console.log(this.state.date)\r\n        let [ofid, uid, dateSta, dateEnd, status] = [\r\n            this.ofidInput.value,\r\n            this.uidInput.state.value,\r\n            this.state.date[0],\r\n            this.state.date[1],\r\n            this.state.status\r\n        ]\r\n        dateSta = JSON.stringify(dateSta)\r\n        dateEnd = JSON.stringify(dateEnd)\r\n        const data = { ofid, uid, dateSta, dateEnd, status }\r\n        console.log(data)\r\n        reqwest({\r\n            url: '/om/searchorderform',\r\n            method: 'post',\r\n            type: 'json',\r\n            data: data\r\n        })\r\n            .then(data => {\r\n                // 数据处理-给每条数据添加独立的key\r\n                if (data.total !== 0) {\r\n                    console.log(data)\r\n                    data.results.forEach(item => {\r\n                        item.key = nanoid()\r\n                    })\r\n                    ofStatusToChinese(data.results)\r\n                    let pagination = this.state.pagination\r\n                    pagination.total = data.total\r\n                    this.setState({\r\n                        data: data.results,\r\n                        pagination\r\n                    })\r\n                    message.success(\"查询成功\")\r\n                } else {\r\n                    message.error(\"查无订单\")\r\n                }\r\n\r\n            })\r\n    }\r\n\r\n    // 点击Table按钮 渲染组件\r\n    handleTableChange = (pagination) => {\r\n        console.log(pagination)\r\n        let { current, pageSize } = pagination\r\n        // console.log(pagination)\r\n        this.setState({\r\n            pagination: {\r\n                current,\r\n                pageSize\r\n            }\r\n        })\r\n        this.fetch({\r\n            pagination,\r\n        });\r\n    };\r\n\r\n    getRandomuserParams = params => ({\r\n        current: params.pagination.current,\r\n        pageSize: params.pagination.pageSize,\r\n        status: this.state.status\r\n    });\r\n\r\n    fetch = (params = {}) => {\r\n        this.setState({ loading: true });\r\n        reqwest({\r\n            // 后端接口\r\n            url: '/om/oflist',\r\n            method: 'post',\r\n            type: 'json',\r\n            // 传递给后端的数据\r\n            data: this.getRandomuserParams(params),\r\n        })\r\n            .then(data => {\r\n                // 数据处理-给每条数据添加独立的key\r\n                data.results.forEach(item => {\r\n                    item.key = nanoid()\r\n                })\r\n                // 数据处理-将status从英文变成中文在页面显示\r\n                console.log(data)\r\n                ofStatusToChinese(data.results)\r\n                this.setState({\r\n                    loading: false,\r\n                    // 根据接口返回的数据源\r\n                    data: data.results,\r\n                    pagination: {\r\n                        ...params.pagination,\r\n                        // 根据接口返回的总条数\r\n                        total: data.total,\r\n                    },\r\n                });\r\n            })\r\n            ;\r\n    };\r\n\r\n    // 点击状态按钮切换渲染\r\n    changeStatusAndPost = (status) => {\r\n        const { pagination } = this.state;\r\n        this.setState({\r\n            status: status\r\n        }, () => {\r\n            this.fetch({ pagination });\r\n        })\r\n\r\n    }\r\n\r\n    willdeliveryClick = () => {\r\n        this.changeStatusAndPost(\"willdelivery\")\r\n    }\r\n    deliveryClick = () => {\r\n        this.changeStatusAndPost(\"delivery\")\r\n    }\r\n    successClick = () => {\r\n        this.changeStatusAndPost(\"success\")\r\n    }\r\n    refundClick = () => {\r\n        this.changeStatusAndPost(\"refund\")\r\n    }\r\n    refundedClick = () => {\r\n        this.changeStatusAndPost(\"refunded\")\r\n    }\r\n\r\n    componentDidMount() {\r\n        const { pagination } = this.state;\r\n        this.fetch({ pagination });\r\n    }\r\n\r\n    render() {\r\n        const { data, pagination, loading } = this.state;\r\n        return (\r\n            <div>\r\n                <Divider style={{ margin: 0 }} />\r\n                <div className=\"Om-head\">\r\n                    <div className=\"Om-desc-wraper\">\r\n                        <Breadcrumb className=\"bdc\">\r\n                            <Breadcrumb.Item>\r\n                                <a href=\"/home\">主页</a>\r\n                            </Breadcrumb.Item>\r\n                            <Breadcrumb.Item>订单信息管理</Breadcrumb.Item>\r\n                        </Breadcrumb>\r\n                        <Descriptions title=\"订单管理\" className=\"desc\">\r\n                            <Descriptions.Item>展示订单信息，查询订单，查看订单状态，处理订单的发货，确认送达和同意退款</Descriptions.Item>\r\n                        </Descriptions>\r\n                    </div>\r\n                    <div className=\"status-switch\">\r\n                        <Space>\r\n                            <Button className=\"status-button\" onClick={this.willdeliveryClick}>待发货</Button>\r\n                            <Button className=\"status-button\" onClick={this.deliveryClick}>配送中</Button>\r\n                            <Button className=\"status-button\" onClick={this.successClick}>已成交</Button>\r\n                            <Button className=\"status-button\" onClick={this.refundClick}>待退款</Button>\r\n                            <Button className=\"status-button\" onClick={this.refundedClick}>已退款</Button>\r\n                        </Space>\r\n                    </div>\r\n                </div>\r\n                <div className=\"search\">\r\n                    <Divider style={{ margin: 0 }} />\r\n                    <Space style={{ marginTop: 20 }} size={20}>\r\n                        <div>\r\n                            订单id:\r\n                            <InputNumber name='Oid' className=\"Om-input\" ref={elev => { this.ofidInput = elev }} />\r\n                        </div>\r\n                        <div>\r\n                            用户id:\r\n                            <Input name=\"commodity\" className=\"Om-input\" ref={elev => { this.uidInput = elev }} />\r\n                        </div>\r\n                        <div>\r\n                            时间:\r\n                            <ConfigProvider locale={zh_CN}>\r\n                                <RangePicker\r\n                                    showTime\r\n                                    format=\"YYYY-MM-DD HH:mm\"\r\n                                    onChange={this.dateOnChange}\r\n                                    ref={elev => { this.dateElev = elev }}\r\n                                />\r\n                            </ConfigProvider>\r\n                        </div>\r\n                        <div style={{ marginLeft: 20 }}>\r\n                            <Button type=\"primary\" shape=\"circle\" icon={<SearchOutlined />} onClick={this.OmSearch} />\r\n                        </div>\r\n                    </Space>\r\n                </div>\r\n                <div className=\"tableWraper contentWraper\">\r\n                    <Table\r\n                        columns={this.getColumns()}\r\n                        dataSource={data}\r\n                        pagination={pagination}\r\n                        loading={loading}\r\n                        onChange={this.handleTableChange}\r\n                        bordered={true}\r\n                        expandable={{\r\n                            onExpand: (boo, item) => {\r\n                                console.log(item, 222222222, this.state.ofDetails)\r\n                                let tag = 1\r\n                                this.state.ofDetails.forEach(detail => {\r\n                                    console.log(detail.user.uid, item.uid)\r\n                                    if (detail.commodityDetails[0].ofid === item.ofid) {\r\n                                        tag = 0\r\n                                    }\r\n                                })\r\n                                if (tag) {\r\n                                    let data = {\r\n                                        ofid: item.ofid,\r\n                                        uid: item.uid\r\n                                    }\r\n                                    reqwest({\r\n                                        url: '/om/ofdetails',\r\n                                        method: \"post\",\r\n                                        type: \"json\",\r\n                                        data: data\r\n                                    })\r\n                                        .then(res => {\r\n                                            console.log(res)\r\n                                            res.commodityDetails.forEach(item => {\r\n                                                item.key = nanoid()\r\n                                            })\r\n                                            let ofDetails = this.state.ofDetails\r\n                                            ofDetails.push(res)\r\n                                            this.setState({\r\n                                                ofDetails: ofDetails\r\n                                            })\r\n                                        })\r\n                                }\r\n                            },\r\n                            expandedRowRender: item => {\r\n                                console.log(item.uid)\r\n                                console.log(this.state.ofDetails)\r\n                                let tag = 0\r\n                                let index\r\n                                this.state.ofDetails.forEach((detail, ind) => {\r\n                                    console.log(detail.user.uid, item.uid)\r\n                                    if (detail.commodityDetails[0].ofid === item.ofid) {\r\n                                        tag = 1\r\n                                        index = ind\r\n                                    }\r\n                                })\r\n                                if (tag) {\r\n                                    if (this.state.ofDetails !== null && this.state.ofDetails[index].user !== undefined && this.state.ofDetails[index].commodityDetails !== undefined) {\r\n                                        const user = this.state.ofDetails[index].user\r\n                                        const commodityDetails = this.state.ofDetails[index].commodityDetails\r\n                                        return <div className=\"sub-order\">\r\n                                            <p>用户收货地址: {user.address} {user.uname} {user.phone} </p>\r\n                                            <p style={{ fontWeight: 600, fontSize: 14 }}>商品详情:</p>\r\n                                            {commodityDetails.map(item => {\r\n                                                return <div className=\"commodity-details\" >\r\n                                                    <div className=\"commodity-details-item\" >编号: {item.cid}</div>\r\n                                                    <div className=\"commodity-details-item\" >名称: {item.commodityName}</div>\r\n                                                    <div className=\"commodity-details-item\" >数量: {item.count}</div>\r\n                                                </div>\r\n                                            })}\r\n                                        </div>\r\n                                    } else {\r\n                                        return <Empty />\r\n                                    }\r\n                                }\r\n                            },\r\n                        }}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}