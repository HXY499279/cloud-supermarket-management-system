{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { AbstractGroup } from '@antv/g-base';\nimport { each } from '@antv/util';\nimport * as Shape from './shape';\nimport { drawChildren, refreshElement } from './util/draw';\nimport { setClip, setTransform } from './util/svg';\nimport { SVG_ATTR_MAP } from './constant';\nimport { createSVGElement } from './util/dom';\n\nvar Group =\n/** @class */\nfunction (_super) {\n  __extends(Group, _super);\n\n  function Group() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  } // SVG 中分组对应实体标签 <g>\n\n\n  Group.prototype.isEntityGroup = function () {\n    return true;\n  };\n\n  Group.prototype.createDom = function () {\n    var element = createSVGElement('g');\n    this.set('el', element);\n    var parent = this.getParent();\n\n    if (parent) {\n      var parentNode = parent.get('el');\n\n      if (parentNode) {\n        parentNode.appendChild(element);\n      } else {\n        // parentNode maybe null for group\n        parentNode = parent.createDom();\n        parent.set('el', parentNode);\n        parentNode.appendChild(element);\n      }\n    }\n\n    return element;\n  }; // 覆盖基类的 afterAttrsChange 方法\n\n\n  Group.prototype.afterAttrsChange = function (targetAttrs) {\n    _super.prototype.afterAttrsChange.call(this, targetAttrs);\n\n    var canvas = this.get('canvas'); // 只有挂载到画布下，才对元素进行实际渲染\n\n    if (canvas && canvas.get('autoDraw')) {\n      var context = canvas.get('context');\n      this.createPath(context, targetAttrs);\n    }\n  };\n  /**\n   * 一些方法调用会引起画布变化\n   * @param {ChangeType} changeType 改变的类型\n   */\n\n\n  Group.prototype.onCanvasChange = function (changeType) {\n    refreshElement(this, changeType);\n  };\n\n  Group.prototype.getShapeBase = function () {\n    return Shape;\n  };\n\n  Group.prototype.getGroupBase = function () {\n    return Group;\n  };\n\n  Group.prototype.draw = function (context) {\n    var children = this.getChildren();\n    var el = this.get('el');\n\n    if (this.get('destroyed')) {\n      if (el) {\n        el.parentNode.removeChild(el);\n      }\n    } else {\n      if (!el) {\n        this.createDom();\n      }\n\n      setClip(this, context);\n      this.createPath(context);\n\n      if (children.length) {\n        drawChildren(context, children);\n      }\n    }\n  };\n  /**\n   * 绘制分组的路径\n   * @param {Defs} context 上下文\n   * @param {ShapeAttrs} targetAttrs 渲染的目标属性\n   */\n\n\n  Group.prototype.createPath = function (context, targetAttrs) {\n    var attrs = this.attr();\n    var el = this.get('el');\n    each(targetAttrs || attrs, function (value, attr) {\n      if (SVG_ATTR_MAP[attr]) {\n        el.setAttribute(SVG_ATTR_MAP[attr], value);\n      }\n    });\n    setTransform(this);\n  };\n\n  return Group;\n}(AbstractGroup);\n\nexport default Group;","map":{"version":3,"sources":["../src/group.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __extends } from \"tslib\";\nimport { AbstractGroup } from '@antv/g-base';\nimport { each } from '@antv/util';\nimport * as Shape from './shape';\nimport { drawChildren, refreshElement } from './util/draw';\nimport { setClip, setTransform } from './util/svg';\nimport { SVG_ATTR_MAP } from './constant';\nimport { createSVGElement } from './util/dom';\nvar Group = /** @class */ (function (_super) {\n    __extends(Group, _super);\n    function Group() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // SVG 中分组对应实体标签 <g>\n    Group.prototype.isEntityGroup = function () {\n        return true;\n    };\n    Group.prototype.createDom = function () {\n        var element = createSVGElement('g');\n        this.set('el', element);\n        var parent = this.getParent();\n        if (parent) {\n            var parentNode = parent.get('el');\n            if (parentNode) {\n                parentNode.appendChild(element);\n            }\n            else {\n                // parentNode maybe null for group\n                parentNode = parent.createDom();\n                parent.set('el', parentNode);\n                parentNode.appendChild(element);\n            }\n        }\n        return element;\n    };\n    // 覆盖基类的 afterAttrsChange 方法\n    Group.prototype.afterAttrsChange = function (targetAttrs) {\n        _super.prototype.afterAttrsChange.call(this, targetAttrs);\n        var canvas = this.get('canvas');\n        // 只有挂载到画布下，才对元素进行实际渲染\n        if (canvas && canvas.get('autoDraw')) {\n            var context = canvas.get('context');\n            this.createPath(context, targetAttrs);\n        }\n    };\n    /**\n     * 一些方法调用会引起画布变化\n     * @param {ChangeType} changeType 改变的类型\n     */\n    Group.prototype.onCanvasChange = function (changeType) {\n        refreshElement(this, changeType);\n    };\n    Group.prototype.getShapeBase = function () {\n        return Shape;\n    };\n    Group.prototype.getGroupBase = function () {\n        return Group;\n    };\n    Group.prototype.draw = function (context) {\n        var children = this.getChildren();\n        var el = this.get('el');\n        if (this.get('destroyed')) {\n            if (el) {\n                el.parentNode.removeChild(el);\n            }\n        }\n        else {\n            if (!el) {\n                this.createDom();\n            }\n            setClip(this, context);\n            this.createPath(context);\n            if (children.length) {\n                drawChildren(context, children);\n            }\n        }\n    };\n    /**\n     * 绘制分组的路径\n     * @param {Defs} context 上下文\n     * @param {ShapeAttrs} targetAttrs 渲染的目标属性\n     */\n    Group.prototype.createPath = function (context, targetAttrs) {\n        var attrs = this.attr();\n        var el = this.get('el');\n        each(targetAttrs || attrs, function (value, attr) {\n            if (SVG_ATTR_MAP[attr]) {\n                el.setAttribute(SVG_ATTR_MAP[attr], value);\n            }\n        });\n        setTransform(this);\n    };\n    return Group;\n}(AbstractGroup));\nexport default Group;\n//# sourceMappingURL=group.js.map"]},"metadata":{},"sourceType":"module"}