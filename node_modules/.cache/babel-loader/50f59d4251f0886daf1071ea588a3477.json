{"ast":null,"code":"/*\n * 抽取pathSegment中的关键点\n * M,L,A,Q,H,V一个端点\n * Q, S抽取一个端点，一个控制点\n * C抽取一个端点，两个控制点\n */\nfunction _getSegmentPoints(segment) {\n  var points = [];\n\n  switch (segment[0]) {\n    case 'M':\n      points.push([segment[1], segment[2]]);\n      break;\n\n    case 'L':\n      points.push([segment[1], segment[2]]);\n      break;\n\n    case 'A':\n      points.push([segment[6], segment[7]]);\n      break;\n\n    case 'Q':\n      points.push([segment[3], segment[4]]);\n      points.push([segment[1], segment[2]]);\n      break;\n\n    case 'T':\n      points.push([segment[1], segment[2]]);\n      break;\n\n    case 'C':\n      points.push([segment[5], segment[6]]);\n      points.push([segment[1], segment[2]]);\n      points.push([segment[3], segment[4]]);\n      break;\n\n    case 'S':\n      points.push([segment[3], segment[4]]);\n      points.push([segment[1], segment[2]]);\n      break;\n\n    case 'H':\n      points.push([segment[1], segment[1]]);\n      break;\n\n    case 'V':\n      points.push([segment[1], segment[1]]);\n      break;\n\n    default:\n  }\n\n  return points;\n} // 将两个点均分成count个点\n\n\nfunction _splitPoints(points, former, count) {\n  var result = [].concat(points);\n  var index;\n  var t = 1 / (count + 1);\n\n  var formerEnd = _getSegmentPoints(former)[0];\n\n  for (var i = 1; i <= count; i++) {\n    t *= i;\n    index = Math.floor(points.length * t);\n\n    if (index === 0) {\n      result.unshift([formerEnd[0] * t + points[index][0] * (1 - t), formerEnd[1] * t + points[index][1] * (1 - t)]);\n    } else {\n      result.splice(index, 0, [formerEnd[0] * t + points[index][0] * (1 - t), formerEnd[1] * t + points[index][1] * (1 - t)]);\n    }\n  }\n\n  return result;\n}\n\nexport default function formatPath(fromPath, toPath) {\n  if (fromPath.length <= 1) {\n    return fromPath;\n  }\n\n  var points;\n\n  for (var i = 0; i < toPath.length; i++) {\n    if (fromPath[i][0] !== toPath[i][0]) {\n      // 获取fromPath的pathSegment的端点，根据toPath的指令对其改造\n      points = _getSegmentPoints(fromPath[i]);\n\n      switch (toPath[i][0]) {\n        case 'M':\n          fromPath[i] = ['M'].concat(points[0]);\n          break;\n\n        case 'L':\n          fromPath[i] = ['L'].concat(points[0]);\n          break;\n\n        case 'A':\n          fromPath[i] = [].concat(toPath[i]);\n          fromPath[i][6] = points[0][0];\n          fromPath[i][7] = points[0][1];\n          break;\n\n        case 'Q':\n          if (points.length < 2) {\n            if (i > 0) {\n              points = _splitPoints(points, fromPath[i - 1], 1);\n            } else {\n              fromPath[i] = toPath[i];\n              break;\n            }\n          }\n\n          fromPath[i] = ['Q'].concat(points.reduce(function (arr, i) {\n            return arr.concat(i);\n          }, []));\n          break;\n\n        case 'T':\n          fromPath[i] = ['T'].concat(points[0]);\n          break;\n\n        case 'C':\n          if (points.length < 3) {\n            if (i > 0) {\n              points = _splitPoints(points, fromPath[i - 1], 2);\n            } else {\n              fromPath[i] = toPath[i];\n              break;\n            }\n          }\n\n          fromPath[i] = ['C'].concat(points.reduce(function (arr, i) {\n            return arr.concat(i);\n          }, []));\n          break;\n\n        case 'S':\n          if (points.length < 2) {\n            if (i > 0) {\n              points = _splitPoints(points, fromPath[i - 1], 1);\n            } else {\n              fromPath[i] = toPath[i];\n              break;\n            }\n          }\n\n          fromPath[i] = ['S'].concat(points.reduce(function (arr, i) {\n            return arr.concat(i);\n          }, []));\n          break;\n\n        default:\n          fromPath[i] = toPath[i];\n      }\n    }\n  }\n\n  return fromPath;\n}","map":{"version":3,"sources":["../src/format-path.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * 抽取pathSegment中的关键点\n * M,L,A,Q,H,V一个端点\n * Q, S抽取一个端点，一个控制点\n * C抽取一个端点，两个控制点\n */\nfunction _getSegmentPoints(segment) {\n    var points = [];\n    switch (segment[0]) {\n        case 'M':\n            points.push([segment[1], segment[2]]);\n            break;\n        case 'L':\n            points.push([segment[1], segment[2]]);\n            break;\n        case 'A':\n            points.push([segment[6], segment[7]]);\n            break;\n        case 'Q':\n            points.push([segment[3], segment[4]]);\n            points.push([segment[1], segment[2]]);\n            break;\n        case 'T':\n            points.push([segment[1], segment[2]]);\n            break;\n        case 'C':\n            points.push([segment[5], segment[6]]);\n            points.push([segment[1], segment[2]]);\n            points.push([segment[3], segment[4]]);\n            break;\n        case 'S':\n            points.push([segment[3], segment[4]]);\n            points.push([segment[1], segment[2]]);\n            break;\n        case 'H':\n            points.push([segment[1], segment[1]]);\n            break;\n        case 'V':\n            points.push([segment[1], segment[1]]);\n            break;\n        default:\n    }\n    return points;\n}\n// 将两个点均分成count个点\nfunction _splitPoints(points, former, count) {\n    var result = [].concat(points);\n    var index;\n    var t = 1 / (count + 1);\n    var formerEnd = _getSegmentPoints(former)[0];\n    for (var i = 1; i <= count; i++) {\n        t *= i;\n        index = Math.floor(points.length * t);\n        if (index === 0) {\n            result.unshift([formerEnd[0] * t + points[index][0] * (1 - t), formerEnd[1] * t + points[index][1] * (1 - t)]);\n        }\n        else {\n            result.splice(index, 0, [formerEnd[0] * t + points[index][0] * (1 - t), formerEnd[1] * t + points[index][1] * (1 - t)]);\n        }\n    }\n    return result;\n}\nexport default function formatPath(fromPath, toPath) {\n    if (fromPath.length <= 1) {\n        return fromPath;\n    }\n    var points;\n    for (var i = 0; i < toPath.length; i++) {\n        if (fromPath[i][0] !== toPath[i][0]) {\n            // 获取fromPath的pathSegment的端点，根据toPath的指令对其改造\n            points = _getSegmentPoints(fromPath[i]);\n            switch (toPath[i][0]) {\n                case 'M':\n                    fromPath[i] = ['M'].concat(points[0]);\n                    break;\n                case 'L':\n                    fromPath[i] = ['L'].concat(points[0]);\n                    break;\n                case 'A':\n                    fromPath[i] = [].concat(toPath[i]);\n                    fromPath[i][6] = points[0][0];\n                    fromPath[i][7] = points[0][1];\n                    break;\n                case 'Q':\n                    if (points.length < 2) {\n                        if (i > 0) {\n                            points = _splitPoints(points, fromPath[i - 1], 1);\n                        }\n                        else {\n                            fromPath[i] = toPath[i];\n                            break;\n                        }\n                    }\n                    fromPath[i] = ['Q'].concat(points.reduce(function (arr, i) { return arr.concat(i); }, []));\n                    break;\n                case 'T':\n                    fromPath[i] = ['T'].concat(points[0]);\n                    break;\n                case 'C':\n                    if (points.length < 3) {\n                        if (i > 0) {\n                            points = _splitPoints(points, fromPath[i - 1], 2);\n                        }\n                        else {\n                            fromPath[i] = toPath[i];\n                            break;\n                        }\n                    }\n                    fromPath[i] = ['C'].concat(points.reduce(function (arr, i) { return arr.concat(i); }, []));\n                    break;\n                case 'S':\n                    if (points.length < 2) {\n                        if (i > 0) {\n                            points = _splitPoints(points, fromPath[i - 1], 1);\n                        }\n                        else {\n                            fromPath[i] = toPath[i];\n                            break;\n                        }\n                    }\n                    fromPath[i] = ['S'].concat(points.reduce(function (arr, i) { return arr.concat(i); }, []));\n                    break;\n                default:\n                    fromPath[i] = toPath[i];\n            }\n        }\n    }\n    return fromPath;\n}\n//# sourceMappingURL=format-path.js.map"]},"metadata":{},"sourceType":"module"}