{"ast":null,"code":"/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\n\nfunction addStop(steps) {\n  var arr = steps.match(regexColorStop);\n\n  if (!arr) {\n    return '';\n  }\n\n  var stops = '';\n  arr.sort(function (a, b) {\n    a = a.split(':');\n    b = b.split(':');\n    return Number(a[0]) - Number(b[0]);\n  });\n  each(arr, function (item) {\n    item = item.split(':');\n    stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n  });\n  return stops;\n}\n\nfunction parseLineGradient(color, el) {\n  var arr = regexLG.exec(color);\n  var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n  var steps = arr[2];\n  var start;\n  var end;\n\n  if (angle >= 0 && angle < 0.5 * Math.PI) {\n    start = {\n      x: 0,\n      y: 0\n    };\n    end = {\n      x: 1,\n      y: 1\n    };\n  } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n    start = {\n      x: 1,\n      y: 0\n    };\n    end = {\n      x: 0,\n      y: 1\n    };\n  } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n    start = {\n      x: 1,\n      y: 1\n    };\n    end = {\n      x: 0,\n      y: 0\n    };\n  } else {\n    start = {\n      x: 0,\n      y: 1\n    };\n    end = {\n      x: 1,\n      y: 0\n    };\n  }\n\n  var tanTheta = Math.tan(angle);\n  var tanTheta2 = tanTheta * tanTheta;\n  var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n  var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n  el.setAttribute('x1', start.x);\n  el.setAttribute('y1', start.y);\n  el.setAttribute('x2', x);\n  el.setAttribute('y2', y);\n  el.innerHTML = addStop(steps);\n}\n\nfunction parseRadialGradient(color, self) {\n  var arr = regexRG.exec(color);\n  var cx = parseFloat(arr[1]);\n  var cy = parseFloat(arr[2]);\n  var r = parseFloat(arr[3]);\n  var steps = arr[4];\n  self.setAttribute('cx', cx);\n  self.setAttribute('cy', cy);\n  self.setAttribute('r', r);\n  self.innerHTML = addStop(steps);\n}\n\nvar Gradient =\n/** @class */\nfunction () {\n  function Gradient(cfg) {\n    this.cfg = {};\n    var el = null;\n    var id = uniqueId('gradient_');\n\n    if (cfg.toLowerCase()[0] === 'l') {\n      el = createSVGElement('linearGradient');\n      parseLineGradient(cfg, el);\n    } else {\n      el = createSVGElement('radialGradient');\n      parseRadialGradient(cfg, el);\n    }\n\n    el.setAttribute('id', id);\n    this.el = el;\n    this.id = id;\n    this.cfg = cfg;\n    return this;\n  }\n\n  Gradient.prototype.match = function (type, attr) {\n    return this.cfg === attr;\n  };\n\n  return Gradient;\n}();\n\nexport default Gradient;","map":{"version":3,"sources":["../../src/defs/gradient.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\nfunction addStop(steps) {\n    var arr = steps.match(regexColorStop);\n    if (!arr) {\n        return '';\n    }\n    var stops = '';\n    arr.sort(function (a, b) {\n        a = a.split(':');\n        b = b.split(':');\n        return Number(a[0]) - Number(b[0]);\n    });\n    each(arr, function (item) {\n        item = item.split(':');\n        stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n    });\n    return stops;\n}\nfunction parseLineGradient(color, el) {\n    var arr = regexLG.exec(color);\n    var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n    var steps = arr[2];\n    var start;\n    var end;\n    if (angle >= 0 && angle < 0.5 * Math.PI) {\n        start = {\n            x: 0,\n            y: 0,\n        };\n        end = {\n            x: 1,\n            y: 1,\n        };\n    }\n    else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n        start = {\n            x: 1,\n            y: 0,\n        };\n        end = {\n            x: 0,\n            y: 1,\n        };\n    }\n    else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n        start = {\n            x: 1,\n            y: 1,\n        };\n        end = {\n            x: 0,\n            y: 0,\n        };\n    }\n    else {\n        start = {\n            x: 0,\n            y: 1,\n        };\n        end = {\n            x: 1,\n            y: 0,\n        };\n    }\n    var tanTheta = Math.tan(angle);\n    var tanTheta2 = tanTheta * tanTheta;\n    var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n    var y = (tanTheta * (end.x - start.x + tanTheta * (end.y - start.y))) / (tanTheta2 + 1) + start.y;\n    el.setAttribute('x1', start.x);\n    el.setAttribute('y1', start.y);\n    el.setAttribute('x2', x);\n    el.setAttribute('y2', y);\n    el.innerHTML = addStop(steps);\n}\nfunction parseRadialGradient(color, self) {\n    var arr = regexRG.exec(color);\n    var cx = parseFloat(arr[1]);\n    var cy = parseFloat(arr[2]);\n    var r = parseFloat(arr[3]);\n    var steps = arr[4];\n    self.setAttribute('cx', cx);\n    self.setAttribute('cy', cy);\n    self.setAttribute('r', r);\n    self.innerHTML = addStop(steps);\n}\nvar Gradient = /** @class */ (function () {\n    function Gradient(cfg) {\n        this.cfg = {};\n        var el = null;\n        var id = uniqueId('gradient_');\n        if (cfg.toLowerCase()[0] === 'l') {\n            el = createSVGElement('linearGradient');\n            parseLineGradient(cfg, el);\n        }\n        else {\n            el = createSVGElement('radialGradient');\n            parseRadialGradient(cfg, el);\n        }\n        el.setAttribute('id', id);\n        this.el = el;\n        this.id = id;\n        this.cfg = cfg;\n        return this;\n    }\n    Gradient.prototype.match = function (type, attr) {\n        return this.cfg === attr;\n    };\n    return Gradient;\n}());\nexport default Gradient;\n//# sourceMappingURL=gradient.js.map"]},"metadata":{},"sourceType":"module"}