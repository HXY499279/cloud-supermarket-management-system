{"ast":null,"code":"var _jsxFileName = \"D:\\\\code\\\\cloud-supermarket-management-system\\\\src\\\\utils\\\\CimAddCommodity\\\\CimAddCommodity.jsx\";\nimport React, { Component } from 'react';\nimport { Form, Input, Button, message, PageHeader, Select, Upload } from 'antd';\nimport { nanoid } from 'nanoid';\nimport './index.css';\nimport reqwest from 'reqwest';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst layout = {\n  labelCol: {\n    span: 8\n  },\n  wrapperCol: {\n    span: 6\n  }\n};\nconst tailLayout = {\n  wrapperCol: {\n    offset: 10,\n    span: 16\n  }\n};\nconst {\n  Option\n} = Select;\nexport default class CimAddCommodity extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      subCategory: [],\n      src: ''\n    };\n    this.property = {\n      name: 'file',\n      action: '/addcommodity',\n      headers: {\n        authorization: 'authorization-text'\n      },\n      onChange: info => {\n        if (info.file.status !== 'uploading') {\n          console.log(\"\", info.file.response);\n        }\n\n        if (info.file.status === 'done') {\n          message.success(`${info.file.name} file uploaded successfully`);\n          this.setState({\n            src: 'https://supermarket.obs.cn-north-4.myhuaweicloud.com/commodity7.jpg'\n          });\n        } else if (info.file.status === 'error') {\n          message.error(`${info.file.name} file upload failed.`);\n        }\n      }\n    };\n\n    this.onFinish = data => {\n      data.currentPrice = data.originalPrice;\n      data.status = \"在售\";\n      data.salesVolume = 0;\n      data.src = this.state.src;\n      delete data.file;\n      console.log(data);\n\n      if (data.commodityName.search(/\\s/) === -1 && data.inventory.search(/\\s/) === -1 && data.originalPlace.search(/\\s/) === -1 && data.originalPrice.search(/\\s/) === -1 && data.originalPlace.search(/\\s/) === -1 && data.weight.search(/\\s/) === -1) {\n        reqwest({\n          // 后端接口\n          url: '/addcommodity',\n          method: 'post',\n          type: 'json',\n          // 传递给后端的数据\n          data: data\n        }).then(res => {\n          console.log(res);\n          message.success(\"商品添加成功！\"); // window.location.href = '/home/cim'\n        }, () => {\n          message.error(\"商品添加失败！\");\n        });\n      } else {\n        message.warning(\"输入内容不能含有空格！\");\n      }\n    };\n\n    this.showCategoryList = () => {\n      return this.state.subCategory.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(Option, {\n          value: `${item.category}`,\n          children: item.category\n        }, nanoid(), false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 20\n        }, this);\n      });\n    };\n\n    this.categorySelectChange = e => {\n      console.log(e);\n      this.categorySelect.value = e;\n    };\n\n    this.componentDidMount = () => {\n      // 请求分类列表\n      reqwest({\n        url: '/category/subcategory',\n        method: 'get',\n        type: 'json'\n      }).then(res => {\n        // console.log(res.results)\n        this.setState({\n          subCategory: res.results\n        });\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"contentWraper\",\n      style: {\n        minHeight: 0\n      },\n      children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n        className: \"site-page-header\",\n        onBack: () => {\n          window.location.href = '/home/cim';\n        },\n        subTitle: \"\\u5546\\u54C1\\u4FE1\\u606F\\u7BA1\\u7406/\\u65B0\\u589E\\u5546\\u54C1\",\n        style: {\n          paddingLeft: 10,\n          backgroundColor: 'white'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, { ...layout,\n        id: \"addCommodityForm\",\n        name: \"basic\",\n        size: \"large\",\n        initialValues: {\n          remember: true\n        },\n        onFinish: this.onFinish,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u540D\\u79F0\",\n          name: \"commodityName\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品名称！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u5206\\u7C7B\",\n          name: \"category\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品分类！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Select, {\n            name: \"category\",\n            style: {\n              width: '100%'\n            } // defaultValue='onsale'\n            ,\n            ref: elev => {\n              this.categorySelect = elev;\n            },\n            onChange: this.categorySelectChange,\n            children: this.showCategoryList()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          hidden: true,\n          name: \"status\",\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            value: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          hidden: true,\n          label: \"\\u5546\\u54C1\\u552E\\u4EF7\",\n          name: \"currentPrice\" // required={false}\n          // rules={[{ required: true, message: '请输入商品售价！' }]}\n          ,\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u4EF7\\u683C\",\n          name: \"originalPrice\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品原价！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u5E93\\u5B58\",\n          name: \"inventory\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品库存！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          hidden: true,\n          name: \"salesVolume\",\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            value: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u89C4\\u683C\",\n          name: \"weight\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品规格！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u4EA7\\u5730\",\n          name: \"originalPlace\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请输入商品产地！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          label: \"\\u5546\\u54C1\\u56FE\\u7247\",\n          name: \"file\",\n          required: false,\n          rules: [{\n            required: true,\n            message: '请上传商品图片！'\n          }],\n          children: /*#__PURE__*/_jsxDEV(Upload, { ...this.property,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              size: \"middle\",\n              style: {\n                borderRadius: 5\n              },\n              children: \"\\u4E0A\\u4F20\\u56FE\\u7247\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailLayout,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            style: {\n              borderRadius: 5\n            },\n            children: \"\\u6DFB\\u52A0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["D:/code/cloud-supermarket-management-system/src/utils/CimAddCommodity/CimAddCommodity.jsx"],"names":["React","Component","Form","Input","Button","message","PageHeader","Select","Upload","nanoid","reqwest","layout","labelCol","span","wrapperCol","tailLayout","offset","Option","CimAddCommodity","state","subCategory","src","property","name","action","headers","authorization","onChange","info","file","status","console","log","response","success","setState","error","onFinish","data","currentPrice","originalPrice","salesVolume","commodityName","search","inventory","originalPlace","weight","url","method","type","then","res","warning","showCategoryList","map","item","index","category","categorySelectChange","e","categorySelect","value","componentDidMount","results","render","minHeight","window","location","href","paddingLeft","backgroundColor","remember","required","width","elev","borderRadius"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Form, Input, Button, message, PageHeader, Select, Upload } from 'antd';\r\nimport { nanoid } from 'nanoid'\r\nimport './index.css'\r\nimport reqwest from 'reqwest';\r\n\r\nconst layout = {\r\n    labelCol: { span: 8 },\r\n    wrapperCol: { span: 6 },\r\n};\r\nconst tailLayout = {\r\n    wrapperCol: { offset: 10, span: 16 },\r\n};\r\n\r\nconst { Option } = Select;\r\n\r\n\r\nexport default class CimAddCommodity extends Component {\r\n\r\n    state = {\r\n        subCategory: [],\r\n        src: ''\r\n    }\r\n\r\n    property = {\r\n        name: 'file',\r\n        action: '/addcommodity',\r\n        headers: {\r\n            authorization: 'authorization-text',\r\n        },\r\n        onChange : (info) => {\r\n            if (info.file.status !== 'uploading') {\r\n                console.log(\"\",info.file.response);\r\n            }\r\n            if (info.file.status === 'done') {\r\n                message.success(`${info.file.name} file uploaded successfully`);\r\n                this.setState({\r\n                    src: 'https://supermarket.obs.cn-north-4.myhuaweicloud.com/commodity7.jpg'\r\n                })\r\n            } else if (info.file.status === 'error') {\r\n                message.error(`${info.file.name} file upload failed.`);\r\n            }\r\n        },\r\n    };\r\n\r\n    onFinish = (data) => {\r\n        data.currentPrice = data.originalPrice\r\n        data.status = \"在售\"\r\n        data.salesVolume = 0\r\n        data.src = this.state.src\r\n        delete data.file\r\n        console.log(data)\r\n        if (\r\n            data.commodityName.search(/\\s/) === -1 &&\r\n            data.inventory.search(/\\s/) === -1 &&\r\n            data.originalPlace.search(/\\s/) === -1 &&\r\n            data.originalPrice.search(/\\s/) === -1 &&\r\n            data.originalPlace.search(/\\s/) === -1 &&\r\n            data.weight.search(/\\s/) === -1\r\n        ) {\r\n            reqwest({\r\n                // 后端接口\r\n                url: '/addcommodity',\r\n                method: 'post',\r\n                type: 'json',\r\n                // 传递给后端的数据\r\n                data: data,\r\n            })\r\n                .then(res => {\r\n                    console.log(res)\r\n                    message.success(\"商品添加成功！\")\r\n                    // window.location.href = '/home/cim'\r\n                }, () => {\r\n                    message.error(\"商品添加失败！\")\r\n                })\r\n        } else {\r\n            message.warning(\"输入内容不能含有空格！\")\r\n        }\r\n    };\r\n\r\n    // 渲染分类下拉框的选项\r\n    showCategoryList = () => {\r\n        return this.state.subCategory.map((item, index) => {\r\n            return <Option value={`${item.category}`} key={nanoid()}>{item.category}</Option>\r\n        })\r\n    }\r\n\r\n    // 获取下拉框的值\r\n    categorySelectChange = (e) => {\r\n        console.log(e)\r\n        this.categorySelect.value = e\r\n    }\r\n\r\n    componentDidMount = () => {\r\n        // 请求分类列表\r\n        reqwest({\r\n            url: '/category/subcategory',\r\n            method: 'get',\r\n            type: 'json'\r\n        })\r\n            .then(res => {\r\n                // console.log(res.results)\r\n                this.setState({\r\n                    subCategory: res.results\r\n                })\r\n            })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"contentWraper\" style={{ minHeight: 0 }}>\r\n                <PageHeader\r\n                    className=\"site-page-header\"\r\n                    onBack={() => { window.location.href = '/home/cim' }}\r\n                    subTitle=\"商品信息管理/新增商品\"\r\n                    style={{ paddingLeft: 10, backgroundColor: 'white' }}\r\n                />\r\n                <Form\r\n                    {...layout}\r\n                    id=\"addCommodityForm\"\r\n                    name=\"basic\"\r\n                    size=\"large\"\r\n                    initialValues={{ remember: true }}\r\n                    onFinish={this.onFinish}\r\n                >\r\n                    <Form.Item\r\n                        label=\"商品名称\"\r\n                        name=\"commodityName\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品名称！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"商品分类\"\r\n                        name=\"category\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品分类！' }]}\r\n                    >\r\n                        <Select\r\n                            name='category'\r\n                            style={{ width: '100%' }}\r\n                            // defaultValue='onsale'\r\n                            ref={elev => { this.categorySelect = elev }}\r\n                            onChange={this.categorySelectChange}\r\n                        >\r\n                            {this.showCategoryList()}\r\n                        </Select >\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        hidden\r\n                        name=\"status\"\r\n                    >\r\n                        <Input value=\"\" />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        hidden\r\n                        label=\"商品售价\"\r\n                        name=\"currentPrice\"\r\n                    // required={false}\r\n                    // rules={[{ required: true, message: '请输入商品售价！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"商品价格\"\r\n                        name=\"originalPrice\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品原价！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n\r\n                    <Form.Item\r\n                        label=\"商品库存\"\r\n                        name=\"inventory\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品库存！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        hidden\r\n                        name=\"salesVolume\"\r\n                    >\r\n                        <Input value=\"\" />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"商品规格\"\r\n                        name=\"weight\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品规格！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"商品产地\"\r\n                        name=\"originalPlace\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请输入商品产地！' }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item\r\n                        label=\"商品图片\"\r\n                        name=\"file\"\r\n                        required={false}\r\n                        rules={[{ required: true, message: '请上传商品图片！' }]}\r\n                    >\r\n                        <Upload {...this.property}>\r\n                            <Button\r\n                                type=\"primary\"\r\n                                size=\"middle\"\r\n                                style={{ borderRadius: 5 }}\r\n                            >\r\n                                上传图片\r\n                            </Button>\r\n                        </Upload>\r\n                    </Form.Item>\r\n\r\n                    <Form.Item {...tailLayout}>\r\n                        <Button type=\"primary\" htmlType=\"submit\" style={{ borderRadius: 5 }}>\r\n                            添加\r\n                        </Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}