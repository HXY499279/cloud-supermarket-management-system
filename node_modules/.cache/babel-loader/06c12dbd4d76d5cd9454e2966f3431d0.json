{"ast":null,"code":"import _classCallCheck from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"D:/code/cloud-supermarket-management-system/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Card,Col,Row}from'antd';import{Chart}from'@antv/g2';import reqwest from'reqwest';import'./index.css';// 引用工具\nimport ofStatusToChinese from'../../../utils/ofStatusToChinese';import numberRefular from'../../../utils/numberRegular';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Dashboard=/*#__PURE__*/function(_Component){_inherits(Dashboard,_Component);var _super=_createSuper(Dashboard);function Dashboard(){var _this;_classCallCheck(this,Dashboard);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={results:{}};return _this;}_createClass(Dashboard,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;reqwest({url:\"/dashboard/showdashboard\",type:\"json\",method:\"get\"}).then(function(res){console.log(res);// 处理数据\nvar ofDetail={sales:{totalSales:res.totalSales,todaySale:res.todaySale},willDelivery:{totalWillDelivery:res.willDelivery},delivery:{totalDelivery:res.delivery},refund:{totalRefund:res.refund},refunded:{totalRefunded:res.refunded},success:{totalSuccess:res.success}};var totalof=res.willDelivery+res.delivery+res.success+res.refund+res.refunded;console.log(typeof(res.willDelivery*1.0/totalof).toFixed(4));var ofSummary=[{item:\"willDelivery\",count:res.willDelivery,percent:numberRefular(res.willDelivery*1.0/totalof)},{item:\"delivery\",count:res.delivery,percent:numberRefular(res.delivery*1.0/totalof)},{item:\"success\",count:res.success,percent:numberRefular(res.success*1.0/totalof)},{item:\"refund\",count:res.refund,percent:numberRefular(res.refund*1.0/totalof)},{item:\"refunded\",count:res.refunded,percent:numberRefular(res.refunded*1.0/totalof)}];var totalFinishedof=res.success+res.refunded;var ofSuccessRate=[{item:\"totalSuccess\",count:res.success,percent:numberRefular(res.success/totalFinishedof)},{item:\"totalRefunded\",count:res.refunded,percent:numberRefular(res.refunded/totalFinishedof)}];ofStatusToChinese(ofSummary);ofStatusToChinese(ofSuccessRate);var results={ofDetail:ofDetail,ofSummary:ofSummary,ofSuccessRate:ofSuccessRate};_this2.setState({results:results},function(){var results=_this2.state.results;var timer1=setTimeout(function(){var data=results.ofSummary;var chart=new Chart({container:'order-from-details',autoFit:true,height:300,width:630});chart.coordinate('theta',{radius:0.75});chart.data(data);chart.scale('percent',{formatter:function formatter(val){val=val*100+'%';return val;}});chart.tooltip({showTitle:false,showMarkers:false});chart.interval().position('percent').color('item').label('percent',{content:function content(data){return\"\".concat(data.item,\": \").concat(data.percent*100,\"%\");}}).adjust('stack');chart.interaction('element-active');chart.render();clearTimeout(timer1);},0);var timer2=setTimeout(function(){var data=results.ofSuccessRate;var chart=new Chart({container:'order-finish-rate',autoFit:true,height:300,width:630});chart.coordinate('theta',{radius:0.75});chart.data(data);chart.scale('percent',{formatter:function formatter(val){val=val*100+'%';return val;}});chart.tooltip({showTitle:false,showMarkers:false});chart.interval().position('percent').color('item').label('percent',{content:function content(data){return\"\".concat(data.item,\": \").concat(data.percent*100,\"%\");}}).adjust('stack');chart.interaction('element-active');chart.render();clearTimeout(timer2);},0);});});}},{key:\"render\",value:function render(){var ofDetail=this.state.results.ofDetail;console.log(ofDetail,this.state.results);return/*#__PURE__*/_jsxs(\"div\",{className:\"contentWraper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"site-card-wrapper \",children:/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{className:\"data-card\",title:\"\\u4ECA\\u65E5\\u65B0\\u589E\\uFF1A\".concat(undefined===ofDetail?0:ofDetail.sales.todaySale,\"\\u5143\"),bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u603B\\u9500\\u552E\\u989D\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"Card_data\",children:[\"\".concat(undefined===ofDetail?0:ofDetail.sales.totalSales),\"\\u5143\"]})]})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{title:\"\\u5F85\\u53D1\\u8D27\",bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u7D2F\\u8BA1\\u6570\\u91CF\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"Card_data\",children:\"\".concat(undefined===ofDetail?0:ofDetail.willDelivery.totalWillDelivery)})]})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{title:\"\\u914D\\u9001\\u4E2D\",bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u7D2F\\u8BA1\\u6570\\u91CF\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"Card_data\",children:\"\".concat(undefined===ofDetail?0:ofDetail.delivery.totalDelivery)})]})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{title:\"\\u5F85\\u9000\\u6B3E\",bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u7D2F\\u8BA1\\u6570\\u91CF\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"Card_data\",children:\"\".concat(undefined===ofDetail?0:ofDetail.refund.totalRefund)})]})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{title:\"\\u5DF2\\u9000\\u6B3E\",bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u7D2F\\u8BA1\\u6570\\u91CF\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"Card_data\",children:\"\".concat(undefined===ofDetail?0:ofDetail.refunded.totalRefunded)})]})})}),/*#__PURE__*/_jsx(Col,{span:4,children:/*#__PURE__*/_jsx(Card,{title:\"\\u5DF2\\u6210\\u4EA4\",bordered:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"dataCard\",children:[\"\\u7D2F\\u8BA1\\u6570\\u91CF\\uFF1A\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"Card_data\",children:\"\".concat(undefined===ofDetail?0:ofDetail.success.totalSuccess)})]})})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-rule\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-wraper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chart-title\",children:\"\\u8BA2\\u5355\\u72B6\\u6001\\u6BD4\\u7387\"}),/*#__PURE__*/_jsx(\"div\",{id:\"order-from-details\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-wraper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chart-title\",children:\"\\u8BA2\\u5355\\u6210\\u8D25\\u6BD4\\u7387\"}),/*#__PURE__*/_jsx(\"div\",{id:\"order-finish-rate\"})]})]})]});}}]);return Dashboard;}(Component);export{Dashboard as default};","map":{"version":3,"sources":["D:/code/cloud-supermarket-management-system/src/components/Content/Dashboard/Dashboard.jsx"],"names":["React","Component","Card","Col","Row","Chart","reqwest","ofStatusToChinese","numberRefular","Dashboard","state","results","url","type","method","then","res","console","log","ofDetail","sales","totalSales","todaySale","willDelivery","totalWillDelivery","delivery","totalDelivery","refund","totalRefund","refunded","totalRefunded","success","totalSuccess","totalof","toFixed","ofSummary","item","count","percent","totalFinishedof","ofSuccessRate","setState","timer1","setTimeout","data","chart","container","autoFit","height","width","coordinate","radius","scale","formatter","val","tooltip","showTitle","showMarkers","interval","position","color","label","content","adjust","interaction","render","clearTimeout","timer2","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Card, Col, Row } from 'antd';\r\nimport { Chart } from '@antv/g2';\r\nimport reqwest from 'reqwest'\r\nimport './index.css';\r\n// 引用工具\r\nimport ofStatusToChinese from '../../../utils/ofStatusToChinese';\r\nimport numberRefular from '../../../utils/numberRegular';\r\n\r\nexport default class Dashboard extends Component {\r\n\r\n    state = {\r\n        results: {\r\n\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        reqwest({\r\n            url: \"/dashboard/showdashboard\",\r\n            type: \"json\",\r\n            method: \"get\",\r\n        })\r\n            .then(res => {\r\n                console.log(res)\r\n                // 处理数据\r\n                let ofDetail = {\r\n                    sales: {\r\n                        totalSales: res.totalSales,\r\n                        todaySale: res.todaySale\r\n                    },\r\n                    willDelivery: {\r\n                        totalWillDelivery: res.willDelivery,\r\n                    },\r\n                    delivery: {\r\n                        totalDelivery: res.delivery,\r\n                    },\r\n                    refund: {\r\n                        totalRefund: res.refund,\r\n                    },\r\n                    refunded: {\r\n                        totalRefunded: res.refunded,\r\n                    },\r\n                    success: {\r\n                        totalSuccess: res.success,\r\n                    }\r\n                }\r\n                let totalof = res.willDelivery + res.delivery + res.success + res.refund + res.refunded\r\n                console.log(typeof (res.willDelivery * 1.0 / totalof).toFixed(4))\r\n                let ofSummary = [\r\n                    {\r\n                        item: \"willDelivery\",\r\n                        count: res.willDelivery,\r\n                        percent: numberRefular(res.willDelivery * 1.0 / totalof)\r\n                    },\r\n                    {\r\n                        item: \"delivery\",\r\n                        count: res.delivery,\r\n                        percent: numberRefular(res.delivery * 1.0 / totalof)\r\n                    },\r\n                    {\r\n                        item: \"success\",\r\n                        count: res.success,\r\n                        percent: numberRefular(res.success * 1.0 / totalof)\r\n                    },\r\n                    {\r\n                        item: \"refund\",\r\n                        count: res.refund,\r\n                        percent: numberRefular(res.refund * 1.0 / totalof)\r\n                    },\r\n                    {\r\n                        item: \"refunded\",\r\n                        count: res.refunded,\r\n                        percent: numberRefular(res.refunded * 1.0 / totalof)\r\n                    }\r\n                ]\r\n                let totalFinishedof = res.success + res.refunded\r\n                let ofSuccessRate = [\r\n                    {\r\n                        item: \"totalSuccess\",\r\n                        count: res.success,\r\n                        percent: numberRefular(res.success / totalFinishedof)\r\n                    },\r\n                    {\r\n                        item: \"totalRefunded\",\r\n                        count: res.refunded,\r\n                        percent: numberRefular(res.refunded / totalFinishedof)\r\n                    }\r\n                ]\r\n                ofStatusToChinese(ofSummary)\r\n                ofStatusToChinese(ofSuccessRate)\r\n                let results = {\r\n                    ofDetail,\r\n                    ofSummary,\r\n                    ofSuccessRate\r\n                }\r\n                this.setState({\r\n                    results: results\r\n                }, () => {\r\n                    const results = this.state.results\r\n                    let timer1 = setTimeout(() => {\r\n                        const data = results.ofSummary;\r\n\r\n                        const chart = new Chart({\r\n                            container: 'order-from-details',\r\n                            autoFit: true,\r\n                            height: 300,\r\n                            width: 630\r\n                        });\r\n\r\n                        chart.coordinate('theta', {\r\n                            radius: 0.75,\r\n                        });\r\n\r\n                        chart.data(data);\r\n\r\n                        chart.scale('percent', {\r\n                            formatter: (val) => {\r\n                                val = val * 100 + '%';\r\n                                return val;\r\n                            },\r\n                        });\r\n\r\n                        chart.tooltip({\r\n                            showTitle: false,\r\n                            showMarkers: false,\r\n                        });\r\n\r\n                        chart\r\n                            .interval()\r\n                            .position('percent')\r\n                            .color('item')\r\n                            .label('percent', {\r\n                                content: (data) => {\r\n                                    return `${data.item}: ${data.percent * 100}%`;\r\n                                },\r\n                            })\r\n                            .adjust('stack');\r\n\r\n                        chart.interaction('element-active');\r\n\r\n                        chart.render();\r\n\r\n                        clearTimeout(timer1)\r\n\r\n                    }, 0);\r\n\r\n                    let timer2 = setTimeout(() => {\r\n                        const data = results.ofSuccessRate;\r\n\r\n                        const chart = new Chart({\r\n                            container: 'order-finish-rate',\r\n                            autoFit: true,\r\n                            height: 300,\r\n                            width: 630\r\n\r\n                        });\r\n\r\n                        chart.coordinate('theta', {\r\n                            radius: 0.75,\r\n                        });\r\n\r\n                        chart.data(data);\r\n\r\n                        chart.scale('percent', {\r\n                            formatter: (val) => {\r\n                                val = val * 100 + '%';\r\n                                return val;\r\n                            },\r\n                        });\r\n\r\n                        chart.tooltip({\r\n                            showTitle: false,\r\n                            showMarkers: false,\r\n                        });\r\n\r\n                        chart\r\n                            .interval()\r\n                            .position('percent')\r\n                            .color('item')\r\n                            .label('percent', {\r\n                                content: (data) => {\r\n                                    return `${data.item}: ${data.percent * 100}%`;\r\n                                },\r\n                            })\r\n                            .adjust('stack');\r\n\r\n                        chart.interaction('element-active');\r\n\r\n                        chart.render();\r\n\r\n                        clearTimeout(timer2)\r\n\r\n                    }, 0);\r\n\r\n                })\r\n            })\r\n    }\r\n\r\n\r\n    render() {\r\n        const ofDetail = this.state.results.ofDetail\r\n        console.log(ofDetail, this.state.results)\r\n        return (\r\n            <div className=\"contentWraper\">\r\n                <div className=\"site-card-wrapper \">\r\n                    <Row gutter={16}>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                className=\"data-card\"\r\n                                title={`今日新增：${(undefined === ofDetail) ? 0 : ofDetail.sales.todaySale}元`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                    总销售额：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.sales.totalSales}`}元\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                title={`待发货`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                    累计数量：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.willDelivery.totalWillDelivery}`}\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                title={`配送中`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                累计数量：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.delivery.totalDelivery}`}\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                title={`待退款`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                累计数量：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.refund.totalRefund}`}\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                title={`已退款`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                累计数量：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.refunded.totalRefunded}`}\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                        <Col span={4}>\r\n                            <Card\r\n                                title={`已成交`}\r\n                                bordered={true}\r\n                            >\r\n                                <div className=\"dataCard\">\r\n                                累计数量：<br />\r\n                                    <div className='Card_data'>\r\n                                        {`${(undefined === ofDetail) ? 0 : ofDetail.success.totalSuccess}`}\r\n                                    </div>\r\n                                </div>\r\n                            </Card>\r\n                        </Col>\r\n                    </Row>\r\n                </div>\r\n                <div className=\"chart-rule\">\r\n                    <div className=\"chart-wraper\">\r\n                        <div className=\"chart-title\" >订单状态比率</div>\r\n                        <div id=\"order-from-details\"></div>\r\n                    </div>\r\n                    <div className=\"chart-wraper\">\r\n                        <div className=\"chart-title\">订单成败比率</div>\r\n                        <div id=\"order-finish-rate\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}